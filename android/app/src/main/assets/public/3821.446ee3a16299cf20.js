"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3821],{3821:(A,R,l)=>{l.r(R),l.d(R,{RegisterPageModule:()=>k});var w=l(177),m=l(4341),s=l(4742),p=l(1739),C=l(467),e=l(3953),M=l(3002),b=l(7185);function _(i,u){1&i&&e.nrm(0,"ion-datetime",18)}const v=[{path:"",component:(()=>{var i;class u{constructor(o,t,r,n){this.router=o,this.authenticatorService=t,this.toastController=r,this.apiService=n,this.user={rut:"",email:"",firstname:"",lastname:"",birthdate:new Date,password:"",confirmPassword:""},this.showPassword=!1,this.showConfirmPassword=!1,this.passwordtoggleicon="eye",this.passwordConfirmtoggleicon="eye",this.passwordFeedback=""}ngOnInit(){}togglePassword(){this.showPassword=!this.showPassword,this.passwordtoggleicon="eye"==this.passwordtoggleicon?"eye-off":"eye"}toggleConfirmPassword(){this.showConfirmPassword=!this.showConfirmPassword,this.passwordConfirmtoggleicon="eye"==this.passwordConfirmtoggleicon?"eye-off":"eye"}registerUser(){var o=this.user.rut.replace(" ","");if(!o)return void this.showAlert("RUT");if(!this.validateRut(o))return void this.showAlert("RUT","El RUT ingresado no es v\xe1lido.");var t=this.user.email.replace(" ","");if(!t)return void this.showAlert("Email");if(!t.endsWith("@duocuc.cl")&&!t.endsWith("@profesor.duoc.cl"))return void this.showAlert("Email","El email ingresado no es institucional.");this.apiService.isRegistered(t).then(f=>{f&&this.showAlert("Email","El email ingresado ya est\xe1 registrado.")}).catch(f=>{console.error("Error al verificar el registro del email:",f)});var r=this.user.firstname.replace(" ","");if(!r)return void this.showAlert("Nombre");var n=this.user.lastname.replace(" ","");if(!n)return void this.showAlert("Apellido");var g=this.user.birthdate;if(!g)return void this.showAlert("Fecha de Nacimiento");var a=this.user.password.replace(" ","");if(!a)return void this.showAlert("Contrase\xf1a");if(!this.esContrasenaRobusta(a))return void this.showAlert("Contrase\xf1a","La contrase\xf1a debe tener al menos 8 caracteres, incluyendo may\xfasculas, min\xfasculas, n\xfameros y caracteres especiales.");if(a!=this.user.confirmPassword.replace(" ",""))return void this.showAlert("Confirmar Contrase\xf1a","Las contrase\xf1as no coinciden.");o=o.replace(" ","").replace(/\./g,"").replace(/-/g,"").slice(0,-1);var P=this.user.rut.slice(-1).replace(" ",""),h=t.endsWith("@duocuc.cl")?"Estudiante":"Profesor";this.authenticatorService.createUser(Number(o),P,t,r,n,g,a,h),this.showRegisterAlert();let F={state:{rut:o,firstname:r,lastname:n}};setTimeout(()=>{this.router.navigate(["/home"],F)},1e3)}showRegisterAlert(){var o=this;return(0,C.A)(function*(){(yield o.toastController.create({message:"Usuario registrado con \xe9xito.",duration:3e3,position:"top",color:"success"})).present()})()}showAlert(o,t){var r=this;return(0,C.A)(function*(){t||(t=`Error en el campo: ${o}`),(yield r.toastController.create({message:t,duration:3e3,position:"top",color:"danger"})).present()})()}validateRut(o){const t=this.truncateRut(o).toUpperCase();if(t.length<2)return!1;const r=t.slice(0,-1),n=t.slice(-1);if(!/^\d+$/.test(r))return!1;let g=0,a=2;for(let h=r.length-1;h>=0;h--)g+=parseInt(r[h],10)*a,a=a<7?a+1:2;const d=11-g%11;return(11===d?"0":10===d?"K":d.toString())===n}truncateRut(o){return o.replace(/\./g,"").replace(/-/g,"").replace(" ","")}esContrasenaRobusta(o){const r=/[A-Z]/.test(o),n=/[a-z]/.test(o),g=/[0-9]/.test(o),a=/[!@#$%^&*(),.?":{}|<>]/.test(o);return o.length>=8&&r&&n&&g&&a}}return(i=u).\u0275fac=function(o){return new(o||i)(e.rXU(p.Ix),e.rXU(M.$),e.rXU(s.K_),e.rXU(b.G))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-register"]],decls:40,vars:14,consts:[[3,"translucent"],["slot","start"],[3,"fullscreen"],["collapse","condense"],["size","large"],["id","container"],["label","RUT","labelPlacement","floating","placeholder","Ingresa tu rut",3,"ngModelChange","ngModel"],["label","Email","labelPlacement","floating","placeholder","Ingresa tu email",3,"ngModelChange","ngModel"],["label","Nombre","labelPlacement","floating","placeholder","Ingresa tu nombre",3,"ngModelChange","ngModel"],["label","Apellido","labelPlacement","floating","placeholder","Ingresa tu apellido",3,"ngModelChange","ngModel"],[1,"date"],[1,"font"],["datetime","date"],[3,"keepContentsMounted"],["label","Contrase\xf1a","labelPlacement","floating","placeholder","Crea tu contrase\xf1a",3,"ngModelChange","ngModel","type"],["slot","end",3,"click","name"],["label","Confirma tu contrase\xf1a","labelPlacement","floating","placeholder","Confirma tu contrase\xf1a",3,"ngModelChange","ngModel","type"],["color","warning","fill","outline",3,"click"],["presentation","date","id","date"]],template:function(o,t){1&o&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-back-button"),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Registro de usuario"),e.k0s()()(),e.j41(6,"ion-content",2)(7,"ion-header",3)(8,"ion-toolbar")(9,"ion-title",4),e.EFF(10,"Registro de usuario"),e.k0s()()(),e.j41(11,"div",5)(12,"ion-card")(13,"ion-card-content")(14,"ion-list")(15,"ion-item")(16,"ion-input",6),e.mxI("ngModelChange",function(n){return e.DH7(t.user.rut,n)||(t.user.rut=n),n}),e.k0s()(),e.j41(17,"ion-item")(18,"ion-input",7),e.mxI("ngModelChange",function(n){return e.DH7(t.user.email,n)||(t.user.email=n),n}),e.k0s()(),e.j41(19,"ion-item")(20,"ion-input",8),e.mxI("ngModelChange",function(n){return e.DH7(t.user.firstname,n)||(t.user.firstname=n),n}),e.k0s()(),e.j41(21,"ion-item")(22,"ion-input",9),e.mxI("ngModelChange",function(n){return e.DH7(t.user.lastname,n)||(t.user.lastname=n),n}),e.k0s()(),e.j41(23,"ion-item")(24,"div",10)(25,"h1",11),e.EFF(26,"Fecha de nacimiento"),e.k0s(),e.nrm(27,"ion-datetime-button",12),e.j41(28,"ion-modal",13),e.DNE(29,_,1,0,"ng-template"),e.k0s()()(),e.j41(30,"ion-item")(31,"ion-input",14),e.mxI("ngModelChange",function(n){return e.DH7(t.user.password,n)||(t.user.password=n),n}),e.k0s(),e.j41(32,"ion-icon",15),e.bIt("click",function(){return t.togglePassword()}),e.k0s()(),e.j41(33,"ion-label"),e.EFF(34),e.k0s(),e.j41(35,"ion-item")(36,"ion-input",16),e.mxI("ngModelChange",function(n){return e.DH7(t.user.confirmPassword,n)||(t.user.confirmPassword=n),n}),e.k0s(),e.j41(37,"ion-icon",15),e.bIt("click",function(){return t.toggleConfirmPassword()}),e.k0s()(),e.j41(38,"ion-button",17),e.bIt("click",function(){return t.registerUser()}),e.EFF(39,"Registrarse"),e.k0s()()()()()()),2&o&&(e.Y8G("translucent",!0),e.R7$(6),e.Y8G("fullscreen",!0),e.R7$(10),e.R50("ngModel",t.user.rut),e.R7$(2),e.R50("ngModel",t.user.email),e.R7$(2),e.R50("ngModel",t.user.firstname),e.R7$(2),e.R50("ngModel",t.user.lastname),e.R7$(6),e.Y8G("keepContentsMounted",!0),e.R7$(3),e.R50("ngModel",t.user.password),e.Y8G("type",t.showPassword?"text":"password"),e.R7$(),e.Y8G("name",t.passwordtoggleicon),e.R7$(2),e.JRh(t.passwordFeedback),e.R7$(2),e.R50("ngModel",t.user.confirmPassword),e.Y8G("type",t.showConfirmPassword?"text":"password"),e.R7$(),e.Y8G("name",t.passwordConfirmtoggleicon))},dependencies:[m.BC,m.vS,s.Jm,s.QW,s.b_,s.I9,s.W9,s.A9,s.K4,s.eU,s.iq,s.$w,s.uz,s.he,s.nf,s.BC,s.ai,s.Sb,s.Je,s.Gw,s.el],styles:["#container[_ngcontent-%COMP%]{text-align:center;position:absolute;left:0;right:0;top:auto}#container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;line-height:22px;color:#8c8c8c;margin:0}#container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.font[_ngcontent-%COMP%]{font-family:Roboto;font-size:16.3px}.date[_ngcontent-%COMP%]{display:flex;gap:15px}"]}),u})()}];let y=(()=>{var i;class u{}return(i=u).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[p.iI.forChild(v),p.iI]}),u})(),k=(()=>{var i;class u{}return(i=u).\u0275fac=function(o){return new(o||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[w.MD,m.YN,s.bv,y]}),u})()}}]);